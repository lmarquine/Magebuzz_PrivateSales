<?php/** @copyright Copyright (c) 2016 www.magebuzz.com*/class Magebuzz_Privatesale_Block_Adminhtml_Invite extends Mage_Adminhtml_Block_Widget_Form_Container {  protected function _prepareLayout() {    $this->setChild('form', $this->getLayout()->createBlock('privatesale/adminhtml_invite_inviteform'));    return parent::_prepareLayout();  }  public function getHeaderText() {    return Mage::helper('privatesale')->__('Invite New Users');  }  public function __construct() {    $addButtonImageUrl = $this->getSkinUrl('images/Privatesale/Add.png');    $deleteButtonImageUrl = $this->getSkinUrl('images/Privatesale/Remove.png');    $url = Mage::getBaseUrl() . 'privatesale/adminhtml_invite/check';    parent::__construct();    $this->removeButton('back');    $this->removeButton('reset');    $this->updateButton('save', 'label', 'Invite');    $this->_formScripts[] = "					var addButton = new Element('img');			addButton.src = '$addButtonImageUrl';			addButton.height = 31;			addButton.id = 'add_button';			addButton.setAttribute('onclick', 'addEmailField()');			var addButtonTd = new Element('td');			addButtonTd.appendChild(addButton);			var notification = new Element('div');			notification.id = 'notification';			var deleteButton = new Element('img');			deleteButton.id = 'deleteButton';			deleteButton.src = '$deleteButtonImageUrl';			deleteButton.height = '31';			deleteButton.setAttribute('onclick', 'removeField(this)');			var row, root;						window.onload = function() {				var email = document.getElementById('email');				email.parentElement.parentElement.appendChild(addButtonTd.cloneNode(true));				email.parentElement.appendChild(notification);				email.name = 'email[]';				row = email.parentElement.parentElement.cloneNode(true);				root = email.parentElement.parentElement.parentElement;			}						function removeField(obj) {				obj.parentElement.parentElement.remove();			}						function addEmailField() {				var url = '$url';				ajaxRequest = new Ajax.Request(url, {				method: 'post',				parameters: 'email=' + document.getElementById('email').value,				onComplete: function(transport) {					if(transport.responseText=='0') {						document.getElementById('notification').remove();						root.insertBefore(row.cloneNode(true), document.getElementById('message').parentElement.parentElement);						document.getElementById('notification').innerHTML = 'OK! You can invite this user! ';						document.getElementById('email').readOnly = true;						document.getElementById('email').parentElement.parentElement.lastElementChild.appendChild(deleteButton.cloneNode(true));						document.getElementById('add_button').remove();						document.getElementById('email').id = 'old';					}					else if(transport.responseText=='1') document.getElementById('notification').innerHTML = 'This user already have an account!';					else document.getElementById('notification').innerHTML = 'Please fill in a valid email!';				},				onFailure : function() {alert('System error');},				onLoading : function() {document.getElementById('notification').innerHTML = 'Checking, please wait ...';},				});			}				";  }}